package com.cowindesktop.cowinbmi;

/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JFrame.java to edit this template
 */

/**
 *
 * @author PHANEENDRA
 */

import javax.swing.*;
import java.awt.*;
import java.util.prefs.Preferences;
import java.util.Iterator;
import java.util.Map;
import static javax.swing.JOptionPane.ERROR_MESSAGE;
import java.io.*;
import java.text.DecimalFormat;
import com.fazecast.jSerialComm.*;
import org.xhtmlrenderer.pdf.ITextRenderer;
import java.text.SimpleDateFormat;  
import java.util.Date;  
import org.json.simple.JSONObject;
import org.json.simple.JSONValue;
import com.fasterxml.jackson.databind.JsonNode;
import com.fasterxml.jackson.databind.ObjectMapper;




public class serialCommunicationGUI extends javax.swing.JFrame {
    
    private String hospitalName;
    private String doctorName;

    private javax.swing.JLabel hospitalNameLabel;
    private javax.swing.JLabel doctorNameLabel;

    private Preferences preferences; 
    
    SerialPort serialPort1;
    OutputStream outputStream1;
    private String dataBuffer = "";
    static boolean isComConnected = false;
    
    static SimpleDateFormat formatter = new SimpleDateFormat("dd/MM/yyyy HH:mm");  
    static SimpleDateFormat formatter2 = new SimpleDateFormat("dd-MM-yyyy_HH-mm");
    static SimpleDateFormat formatter3 = new SimpleDateFormat("yyyyMMddHHmm");
    static Date date = new Date(); 
    static String currentDate = formatter.format(date);
    static String currentDate2 = formatter2.format(date);
    static String currentDate3 = formatter3.format(date);
    
    static String name ="";
    static int age;
    static String gender = "";
    static double bmi;
    static double height;
    static double weight;
    static double heightMtrValue = 0;
    static double bodyFat = 0;
    static double overWeight = 0;
    static double underWeight = 0;
    static double totalBodyWater;
    static double bmr;
    static String nutrStatus ="";
    static String spo2 ="";
    static String heartRate ="";
    static String systolicPressure ="";
    static String diastolicPressure ="";
    static int bodyAge;
    static double skeletalMass;
    static double leanBodyMass;
    static String nutrition;
    static String invoice;
    static final double minThreshold = 18;
    static final double maxThreshold = 25;
    
    static String company ="";
    static String phone ="";
    static String model ="";
    static String heightError ="";
    static String maxHeight ="";
    static String weightFactor ="";
    static String weightError ="";
    
    

    DecimalFormat decimalFormat = new DecimalFormat("#.#");
    /**
     * Creates new form serialCommunicationGUI
     */

        
        
        
    public serialCommunicationGUI() {
        initComponents();
        
        comport_jComboBox.setEnabled( true );
        connect_jButton.setEnabled( true );
        disconnect_jButton.setEnabled( false );
        calculate_jButton.setEnabled(false);
        report_jButton.setEnabled(false);
        
        
        
        // Initialize the Preferences object for persistent storage
        preferences = Preferences.userNodeForPackage(serialCommunicationGUI.class);

        // Load the hospital name and doctor name from preferences or use default values
        hospitalName = preferences.get("hospitalName", "Default Hospital");
        doctorName = preferences.get("doctorName", "Default Doctor");

        // Create and initialize the labels with loaded values
        hospitalNameLabel = new javax.swing.JLabel("Hospital Name: " + hospitalName);
        doctorNameLabel = new javax.swing.JLabel("Doctor Name: " + doctorName);

        // Add labels to your content pane
        java.awt.Container contentPane = getContentPane();
        contentPane.add(hospitalNameLabel);
        contentPane.add(doctorNameLabel);
        
        // Update the corresponding JLabel components in the main frame
        hospital_jLabel.setText(hospitalName);
        doctor_jLabel.setText(doctorName);
    }
   /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel8 = new javax.swing.JPanel();
        jLabel2 = new javax.swing.JLabel();
        jPanel3 = new javax.swing.JPanel();
        jPanel5 = new javax.swing.JPanel();
        jLabel29 = new javax.swing.JLabel();
        jLabel32 = new javax.swing.JLabel();
        doctor_jLabel = new javax.swing.JLabel();
        hospital_jLabel = new javax.swing.JLabel();
        change_jButton = new javax.swing.JButton();
        jPanel6 = new javax.swing.JPanel();
        jLabel30 = new javax.swing.JLabel();
        comport_jComboBox = new javax.swing.JComboBox<>();
        connect_jButton = new javax.swing.JButton();
        disconnect_jButton = new javax.swing.JButton();
        jLabel1 = new javax.swing.JLabel();
        jPanel2 = new javax.swing.JPanel();
        jPanel1 = new javax.swing.JPanel();
        name_jTextField = new javax.swing.JTextField();
        jLabel7 = new javax.swing.JLabel();
        jLabel8 = new javax.swing.JLabel();
        jLabel9 = new javax.swing.JLabel();
        age_jSpinner = new javax.swing.JSpinner(new SpinnerNumberModel(0, 0, Integer.MAX_VALUE, 1));
        jLabel22 = new javax.swing.JLabel();
        jLabel21 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        jLabel4 = new javax.swing.JLabel();
        male_button = new java.awt.Button();
        female_button = new java.awt.Button();
        submit_jButton = new javax.swing.JButton();
        jLabel27 = new javax.swing.JLabel();
        jPanel4 = new javax.swing.JPanel();
        jPanel11 = new javax.swing.JPanel();
        jLabel23 = new javax.swing.JLabel();
        jLabel25 = new javax.swing.JLabel();
        jLabel20 = new javax.swing.JLabel();
        jLabel26 = new javax.swing.JLabel();
        systolicPressure_jTextField = new javax.swing.JTextField();
        parameter_jLabel1 = new javax.swing.JLabel();
        parameter_jLabel2 = new javax.swing.JLabel();
        parameter_jLabel3 = new javax.swing.JLabel();
        parameter_jLabel4 = new javax.swing.JLabel();
        diastolicPressure_jTextField = new javax.swing.JTextField();
        spo2_jSlider = new javax.swing.JSlider();
        spo2Val_jLabel = new javax.swing.JLabel();
        jLabel19 = new javax.swing.JLabel();
        heartRate_jSlider = new javax.swing.JSlider();
        heartRateVal_jLabel = new javax.swing.JLabel();
        calculate_jButton = new javax.swing.JButton();
        report_jButton = new javax.swing.JButton();
        clear_jButton = new javax.swing.JButton();
        jPanel10 = new javax.swing.JPanel();
        jLabel13 = new javax.swing.JLabel();
        jLabel14 = new javax.swing.JLabel();
        jLabel15 = new javax.swing.JLabel();
        jLabel16 = new javax.swing.JLabel();
        jLabel17 = new javax.swing.JLabel();
        jLabel18 = new javax.swing.JLabel();
        bodyFat_jLabel = new javax.swing.JLabel();
        totalBodyWater_jLabel = new javax.swing.JLabel();
        bmr_jLabel = new javax.swing.JLabel();
        nutritionStatus_jLabel = new javax.swing.JLabel();
        underWeight_jLabel = new javax.swing.JLabel();
        overWeight_jLabel = new javax.swing.JLabel();
        parameter_jLabel5 = new javax.swing.JLabel();
        parameter_jLabel6 = new javax.swing.JLabel();
        parameter_jLabel8 = new javax.swing.JLabel();
        parameter_jLabel9 = new javax.swing.JLabel();
        parameter_jLabel10 = new javax.swing.JLabel();
        jLabel28 = new javax.swing.JLabel();
        bodyAge_jLabel = new javax.swing.JLabel();
        jLabel31 = new javax.swing.JLabel();
        skeletalMass_jLabel = new javax.swing.JLabel();
        parameter_jLabel14 = new javax.swing.JLabel();
        jLabel33 = new javax.swing.JLabel();
        leanBodyMass_jLabel = new javax.swing.JLabel();
        parameter_jLabel15 = new javax.swing.JLabel();
        jPanel7 = new javax.swing.JPanel();
        jPanel9 = new javax.swing.JPanel();
        jLabel10 = new javax.swing.JLabel();
        jLabel12 = new javax.swing.JLabel();
        jLabel11 = new javax.swing.JLabel();
        height_jLabel = new javax.swing.JLabel();
        weight_jLabel = new javax.swing.JLabel();
        bmi_jLabel = new javax.swing.JLabel();
        parameter_jLabel7 = new javax.swing.JLabel();
        parameter_jLabel11 = new javax.swing.JLabel();
        parameter_jLabel12 = new javax.swing.JLabel();
        jLabel5 = new javax.swing.JLabel();
        settings_jButton = new javax.swing.JButton();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setTitle("CoWin BMI");

        jPanel8.setBackground(new java.awt.Color(212, 240, 255));

        jLabel2.setFont(new java.awt.Font("Segoe UI", 3, 24)); // NOI18N
        jLabel2.setForeground(new java.awt.Color(250, 134, 19));
        jLabel2.setText("Cowin Technologies Private Limited");

        jPanel3.setBackground(new java.awt.Color(0, 204, 204));
        jPanel3.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED));

        jPanel5.setBackground(new java.awt.Color(0, 204, 204));

        jLabel29.setFont(new java.awt.Font("Yu Gothic UI", 1, 20)); // NOI18N
        jLabel29.setForeground(new java.awt.Color(153, 153, 153));
        jLabel29.setText("Doctor :");

        jLabel32.setFont(new java.awt.Font("Yu Gothic UI", 1, 20)); // NOI18N
        jLabel32.setForeground(new java.awt.Color(153, 153, 153));
        jLabel32.setText("Hospital :");

        doctor_jLabel.setFont(new java.awt.Font("Calisto MT", 1, 22)); // NOI18N
        doctor_jLabel.setForeground(new java.awt.Color(39, 51, 133));
        doctor_jLabel.setText("d name");

        hospital_jLabel.setFont(new java.awt.Font("Calisto MT", 1, 22)); // NOI18N
        hospital_jLabel.setForeground(new java.awt.Color(39, 51, 133));
        hospital_jLabel.setText("h name");

        javax.swing.GroupLayout jPanel5Layout = new javax.swing.GroupLayout(jPanel5);
        jPanel5.setLayout(jPanel5Layout);
        jPanel5Layout.setHorizontalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel32)
                    .addComponent(jLabel29))
                .addGap(18, 18, 18)
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(hospital_jLabel)
                    .addComponent(doctor_jLabel))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel5Layout.setVerticalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel5Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel32)
                    .addComponent(hospital_jLabel))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel29)
                    .addComponent(doctor_jLabel))
                .addContainerGap())
        );

        change_jButton.setText("Change");
        change_jButton.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        change_jButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                change_jButtonActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addGap(17, 17, 17)
                .addComponent(jPanel5, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(change_jButton)
                .addContainerGap())
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel3Layout.createSequentialGroup()
                        .addGap(0, 0, Short.MAX_VALUE)
                        .addComponent(change_jButton))
                    .addComponent(jPanel5, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );

        jPanel6.setBackground(new java.awt.Color(212, 240, 255));
        jPanel6.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED));

        jLabel30.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel30.setText("COM PORT");

        comport_jComboBox.setFont(new java.awt.Font("Segoe UI", 0, 13)); // NOI18N
        comport_jComboBox.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        comport_jComboBox.addPopupMenuListener(new javax.swing.event.PopupMenuListener() {
            public void popupMenuCanceled(javax.swing.event.PopupMenuEvent evt) {
            }
            public void popupMenuWillBecomeInvisible(javax.swing.event.PopupMenuEvent evt) {
            }
            public void popupMenuWillBecomeVisible(javax.swing.event.PopupMenuEvent evt) {
                comport_jComboBoxPopupMenuWillBecomeVisible(evt);
            }
        });

        connect_jButton.setText("Connect");
        connect_jButton.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        connect_jButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                connect_jButtonActionPerformed(evt);
            }
        });

        disconnect_jButton.setText("Disconnect");
        disconnect_jButton.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        disconnect_jButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                disconnect_jButtonActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel6Layout = new javax.swing.GroupLayout(jPanel6);
        jPanel6.setLayout(jPanel6Layout);
        jPanel6Layout.setHorizontalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addGap(18, 18, 18)
                .addComponent(jLabel30, javax.swing.GroupLayout.PREFERRED_SIZE, 82, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(comport_jComboBox, javax.swing.GroupLayout.PREFERRED_SIZE, 91, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(7, Short.MAX_VALUE))
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel6Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(connect_jButton, javax.swing.GroupLayout.PREFERRED_SIZE, 88, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(disconnect_jButton)
                .addGap(12, 12, 12))
        );
        jPanel6Layout.setVerticalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addContainerGap(13, Short.MAX_VALUE)
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(comport_jComboBox, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel30))
                .addGap(18, 18, 18)
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(disconnect_jButton)
                    .addComponent(connect_jButton))
                .addGap(16, 16, 16))
        );

        jLabel1.setFont(new java.awt.Font("Segoe UI", 0, 30)); // NOI18N
        jLabel1.setForeground(new java.awt.Color(9, 30, 62));

        jPanel2.setBackground(new java.awt.Color(255, 255, 255));
        jPanel2.setBorder(javax.swing.BorderFactory.createTitledBorder(""));

        jPanel1.setBackground(new java.awt.Color(255, 204, 102));
        jPanel1.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED));

        name_jTextField.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N

        jLabel7.setFont(new java.awt.Font("Yu Gothic UI", 1, 20)); // NOI18N
        jLabel7.setText("Age :");

        jLabel8.setFont(new java.awt.Font("Yu Gothic UI", 1, 20)); // NOI18N
        jLabel8.setText("Gender:");

        jLabel9.setFont(new java.awt.Font("Yu Gothic UI", 1, 20)); // NOI18N
        jLabel9.setText("Name :");

        age_jSpinner.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
        age_jSpinner.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));

        jLabel22.setFont(new java.awt.Font("Segoe UI", 0, 20)); // NOI18N

        jLabel21.setFont(new java.awt.Font("Segoe UI", 0, 20)); // NOI18N

        jLabel3.setFont(new java.awt.Font("Yu Gothic", 0, 14)); // NOI18N
        jLabel3.setForeground(new java.awt.Color(153, 153, 153));
        jLabel3.setText("Enter your details :");

        jLabel6.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/male.png"))); // NOI18N

        male_button.setBackground(new java.awt.Color(255, 255, 255));
        male_button.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        male_button.setLabel("Male");
        male_button.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                male_buttonActionPerformed(evt);
            }
        });

        female_button.setBackground(new java.awt.Color(255, 255, 255));
        female_button.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        female_button.setLabel("Female");
        female_button.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                female_buttonActionPerformed(evt);
            }
        });

        submit_jButton.setBackground(new java.awt.Color(255, 204, 102));
        submit_jButton.setFont(new java.awt.Font("Segoe UI", 0, 16)); // NOI18N
        submit_jButton.setText("Submit");
        submit_jButton.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        submit_jButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                submit_jButtonActionPerformed(evt);
            }
        });

        jLabel27.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/female.png"))); // NOI18N

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGap(138, 138, 138)
                        .addComponent(jLabel3))
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGap(14, 14, 14)
                        .addComponent(jLabel8)
                        .addGap(26, 26, 26)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel6)
                            .addComponent(male_button, javax.swing.GroupLayout.PREFERRED_SIZE, 73, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(30, 30, 30)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(female_button, javax.swing.GroupLayout.PREFERRED_SIZE, 73, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addGroup(jPanel1Layout.createSequentialGroup()
                                .addComponent(jLabel27)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(jLabel4))))
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGap(14, 14, 14)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel1Layout.createSequentialGroup()
                                .addGap(301, 301, 301)
                                .addComponent(jLabel22)
                                .addGap(352, 352, 352)
                                .addComponent(jLabel21))
                            .addGroup(jPanel1Layout.createSequentialGroup()
                                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(jLabel9)
                                    .addComponent(jLabel7))
                                .addGap(18, 18, 18)
                                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(age_jSpinner, javax.swing.GroupLayout.PREFERRED_SIZE, 73, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(name_jTextField, javax.swing.GroupLayout.PREFERRED_SIZE, 290, javax.swing.GroupLayout.PREFERRED_SIZE)))))
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGap(119, 119, 119)
                        .addComponent(submit_jButton, javax.swing.GroupLayout.PREFERRED_SIZE, 139, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel3)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(name_jTextField, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel9))
                .addGap(34, 34, 34)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(age_jSpinner, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel7))
                .addGap(41, 41, 41)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jLabel8)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createSequentialGroup()
                        .addGap(0, 0, Short.MAX_VALUE)
                        .addComponent(jLabel4)
                        .addGap(120, 120, 120))
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(jLabel6, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(jLabel27, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                        .addGap(20, 20, 20)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(female_button, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(male_button, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(submit_jButton, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(9, 9, 9)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel21)
                    .addComponent(jLabel22))
                .addGap(93, 93, 93))
        );

        jPanel4.setBackground(new java.awt.Color(255, 255, 204));
        jPanel4.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED));

        jPanel11.setBackground(new java.awt.Color(255, 255, 204));

        jLabel23.setFont(new java.awt.Font("Yu Gothic UI", 1, 20)); // NOI18N
        jLabel23.setForeground(new java.awt.Color(73, 115, 149));
        jLabel23.setText("Heart Rate :");

        jLabel25.setFont(new java.awt.Font("Yu Gothic", 0, 14)); // NOI18N
        jLabel25.setForeground(new java.awt.Color(153, 153, 153));
        jLabel25.setText("Blood Pressure");

        jLabel20.setFont(new java.awt.Font("Yu Gothic UI", 1, 20)); // NOI18N
        jLabel20.setForeground(new java.awt.Color(73, 115, 149));
        jLabel20.setText("SYS :");

        jLabel26.setFont(new java.awt.Font("Yu Gothic UI", 1, 20)); // NOI18N
        jLabel26.setForeground(new java.awt.Color(73, 115, 149));
        jLabel26.setText("DIA :");

        systolicPressure_jTextField.setFont(new java.awt.Font("Comic Sans MS", 0, 14)); // NOI18N
        systolicPressure_jTextField.setText("0");

        parameter_jLabel1.setFont(new java.awt.Font("Comic Sans MS", 1, 18)); // NOI18N
        parameter_jLabel1.setForeground(new java.awt.Color(153, 153, 153));
        parameter_jLabel1.setText("%");

        parameter_jLabel2.setFont(new java.awt.Font("Comic Sans MS", 1, 18)); // NOI18N
        parameter_jLabel2.setForeground(new java.awt.Color(153, 153, 153));
        parameter_jLabel2.setText("mmHg");

        parameter_jLabel3.setFont(new java.awt.Font("Comic Sans MS", 1, 18)); // NOI18N
        parameter_jLabel3.setForeground(new java.awt.Color(153, 153, 153));
        parameter_jLabel3.setText("bpm");

        parameter_jLabel4.setFont(new java.awt.Font("Comic Sans MS", 1, 18)); // NOI18N
        parameter_jLabel4.setForeground(new java.awt.Color(153, 153, 153));
        parameter_jLabel4.setText("mmHg");

        diastolicPressure_jTextField.setFont(new java.awt.Font("Comic Sans MS", 0, 14)); // NOI18N
        diastolicPressure_jTextField.setText("0");

        spo2_jSlider.setMinimum(40);
        spo2_jSlider.setValue(98);
        spo2_jSlider.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        spo2_jSlider.addChangeListener(new javax.swing.event.ChangeListener() {
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                spo2_jSliderStateChanged(evt);
            }
        });

        spo2Val_jLabel.setBackground(new java.awt.Color(0, 0, 0));
        spo2Val_jLabel.setFont(new java.awt.Font("Comic Sans MS", 1, 18)); // NOI18N
        spo2Val_jLabel.setText("-");

        jLabel19.setFont(new java.awt.Font("Yu Gothic UI", 1, 20)); // NOI18N
        jLabel19.setForeground(new java.awt.Color(73, 115, 149));
        jLabel19.setText("SPO2 :");

        heartRate_jSlider.setMaximum(220);
        heartRate_jSlider.setMinimum(40);
        heartRate_jSlider.setValue(70);
        heartRate_jSlider.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        heartRate_jSlider.addChangeListener(new javax.swing.event.ChangeListener() {
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                heartRate_jSliderStateChanged(evt);
            }
        });

        heartRateVal_jLabel.setFont(new java.awt.Font("Comic Sans MS", 1, 18)); // NOI18N
        heartRateVal_jLabel.setText("-");

        javax.swing.GroupLayout jPanel11Layout = new javax.swing.GroupLayout(jPanel11);
        jPanel11.setLayout(jPanel11Layout);
        jPanel11Layout.setHorizontalGroup(
            jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel11Layout.createSequentialGroup()
                .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel11Layout.createSequentialGroup()
                        .addComponent(jLabel20)
                        .addGap(18, 18, 18)
                        .addComponent(systolicPressure_jTextField, javax.swing.GroupLayout.PREFERRED_SIZE, 79, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addComponent(parameter_jLabel2))
                    .addComponent(jLabel25)
                    .addGroup(jPanel11Layout.createSequentialGroup()
                        .addComponent(jLabel26, javax.swing.GroupLayout.PREFERRED_SIZE, 44, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addComponent(diastolicPressure_jTextField, javax.swing.GroupLayout.PREFERRED_SIZE, 79, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addComponent(parameter_jLabel4))
                    .addGroup(jPanel11Layout.createSequentialGroup()
                        .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel23)
                            .addComponent(jLabel19))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addGroup(jPanel11Layout.createSequentialGroup()
                                .addComponent(spo2_jSlider, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addComponent(spo2Val_jLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 46, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(jPanel11Layout.createSequentialGroup()
                                .addComponent(heartRate_jSlider, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(heartRateVal_jLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 46, javax.swing.GroupLayout.PREFERRED_SIZE)))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(parameter_jLabel1)
                            .addComponent(parameter_jLabel3))))
                .addContainerGap(26, Short.MAX_VALUE))
        );
        jPanel11Layout.setVerticalGroup(
            jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel11Layout.createSequentialGroup()
                .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(jPanel11Layout.createSequentialGroup()
                        .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel19)
                            .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(spo2_jSlider, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(spo2Val_jLabel)
                                .addComponent(parameter_jLabel1)))
                        .addGap(18, 18, 18)
                        .addComponent(jLabel23))
                    .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(heartRate_jSlider, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(heartRateVal_jLabel)
                        .addComponent(parameter_jLabel3)))
                .addGap(26, 26, 26)
                .addComponent(jLabel25)
                .addGap(18, 18, 18)
                .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel20)
                    .addComponent(systolicPressure_jTextField)
                    .addComponent(parameter_jLabel2))
                .addGap(18, 18, 18)
                .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel26, javax.swing.GroupLayout.PREFERRED_SIZE, 27, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(diastolicPressure_jTextField)
                    .addComponent(parameter_jLabel4))
                .addContainerGap(25, Short.MAX_VALUE))
        );

        calculate_jButton.setBackground(new java.awt.Color(255, 255, 204));
        calculate_jButton.setFont(new java.awt.Font("Segoe UI", 0, 16)); // NOI18N
        calculate_jButton.setText("Calculate");
        calculate_jButton.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        calculate_jButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                calculate_jButtonActionPerformed(evt);
            }
        });

        report_jButton.setBackground(new java.awt.Color(212, 240, 255));
        report_jButton.setFont(new java.awt.Font("Segoe UI", 0, 16)); // NOI18N
        report_jButton.setText("Genrate Report");
        report_jButton.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        report_jButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                report_jButtonActionPerformed(evt);
            }
        });

        clear_jButton.setBackground(new java.awt.Color(255, 255, 204));
        clear_jButton.setFont(new java.awt.Font("Segoe UI", 0, 16)); // NOI18N
        clear_jButton.setText("Clear");
        clear_jButton.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        clear_jButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                clear_jButtonActionPerformed(evt);
            }
        });

        jPanel10.setBackground(new java.awt.Color(255, 255, 204));

        jLabel13.setFont(new java.awt.Font("Yu Gothic UI", 1, 20)); // NOI18N
        jLabel13.setForeground(new java.awt.Color(73, 115, 149));
        jLabel13.setText("Body Fat :");

        jLabel14.setFont(new java.awt.Font("Yu Gothic UI", 1, 20)); // NOI18N
        jLabel14.setForeground(new java.awt.Color(73, 115, 149));
        jLabel14.setText("Total Body Water :");

        jLabel15.setFont(new java.awt.Font("Yu Gothic UI", 1, 20)); // NOI18N
        jLabel15.setForeground(new java.awt.Color(73, 115, 149));
        jLabel15.setText("BMR :");

        jLabel16.setFont(new java.awt.Font("Yu Gothic UI", 1, 20)); // NOI18N
        jLabel16.setForeground(new java.awt.Color(73, 115, 149));
        jLabel16.setText("Nutrition Status :");

        jLabel17.setFont(new java.awt.Font("Yu Gothic UI", 1, 20)); // NOI18N
        jLabel17.setForeground(new java.awt.Color(73, 115, 149));
        jLabel17.setText("Under Weight :");

        jLabel18.setFont(new java.awt.Font("Yu Gothic UI", 1, 20)); // NOI18N
        jLabel18.setForeground(new java.awt.Color(73, 115, 149));
        jLabel18.setText("Over Weight :");

        bodyFat_jLabel.setFont(new java.awt.Font("Comic Sans MS", 1, 18)); // NOI18N
        bodyFat_jLabel.setText("n/a");

        totalBodyWater_jLabel.setFont(new java.awt.Font("Comic Sans MS", 1, 18)); // NOI18N
        totalBodyWater_jLabel.setText("n/a");

        bmr_jLabel.setFont(new java.awt.Font("Comic Sans MS", 1, 18)); // NOI18N
        bmr_jLabel.setText("n/a");

        nutritionStatus_jLabel.setFont(new java.awt.Font("Comic Sans MS", 1, 18)); // NOI18N
        nutritionStatus_jLabel.setText("n/a");

        underWeight_jLabel.setFont(new java.awt.Font("Comic Sans MS", 1, 18)); // NOI18N
        underWeight_jLabel.setText("n/a");

        overWeight_jLabel.setFont(new java.awt.Font("Comic Sans MS", 1, 18)); // NOI18N
        overWeight_jLabel.setText("n/a");

        parameter_jLabel5.setFont(new java.awt.Font("Comic Sans MS", 1, 18)); // NOI18N
        parameter_jLabel5.setForeground(new java.awt.Color(153, 153, 153));
        parameter_jLabel5.setText("%");

        parameter_jLabel6.setFont(new java.awt.Font("Comic Sans MS", 1, 18)); // NOI18N
        parameter_jLabel6.setForeground(new java.awt.Color(153, 153, 153));
        parameter_jLabel6.setText("%");

        parameter_jLabel8.setFont(new java.awt.Font("Comic Sans MS", 1, 16)); // NOI18N
        parameter_jLabel8.setForeground(new java.awt.Color(153, 153, 153));
        parameter_jLabel8.setText("cal/day");

        parameter_jLabel9.setFont(new java.awt.Font("Comic Sans MS", 1, 18)); // NOI18N
        parameter_jLabel9.setForeground(new java.awt.Color(153, 153, 153));
        parameter_jLabel9.setText("kg");

        parameter_jLabel10.setFont(new java.awt.Font("Comic Sans MS", 1, 18)); // NOI18N
        parameter_jLabel10.setForeground(new java.awt.Color(153, 153, 153));
        parameter_jLabel10.setText("kg");

        jLabel28.setFont(new java.awt.Font("Yu Gothic UI", 1, 20)); // NOI18N
        jLabel28.setForeground(new java.awt.Color(73, 115, 149));
        jLabel28.setText("Body Age :");

        bodyAge_jLabel.setFont(new java.awt.Font("Comic Sans MS", 1, 18)); // NOI18N
        bodyAge_jLabel.setText("n/a");

        jLabel31.setFont(new java.awt.Font("Yu Gothic UI", 1, 20)); // NOI18N
        jLabel31.setForeground(new java.awt.Color(73, 115, 149));
        jLabel31.setText("Skeletal Mass :");

        skeletalMass_jLabel.setFont(new java.awt.Font("Comic Sans MS", 1, 18)); // NOI18N
        skeletalMass_jLabel.setText("n/a");

        parameter_jLabel14.setFont(new java.awt.Font("Comic Sans MS", 1, 18)); // NOI18N
        parameter_jLabel14.setForeground(new java.awt.Color(153, 153, 153));
        parameter_jLabel14.setText("kg");

        jLabel33.setFont(new java.awt.Font("Yu Gothic UI", 1, 20)); // NOI18N
        jLabel33.setForeground(new java.awt.Color(73, 115, 149));
        jLabel33.setText("Lean Body Mass :");

        leanBodyMass_jLabel.setFont(new java.awt.Font("Comic Sans MS", 1, 18)); // NOI18N
        leanBodyMass_jLabel.setText("n/a");

        parameter_jLabel15.setFont(new java.awt.Font("Comic Sans MS", 1, 18)); // NOI18N
        parameter_jLabel15.setForeground(new java.awt.Color(153, 153, 153));
        parameter_jLabel15.setText("kg");

        javax.swing.GroupLayout jPanel10Layout = new javax.swing.GroupLayout(jPanel10);
        jPanel10.setLayout(jPanel10Layout);
        jPanel10Layout.setHorizontalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel10Layout.createSequentialGroup()
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel14)
                    .addComponent(jLabel15)
                    .addComponent(jLabel16)
                    .addComponent(jLabel17)
                    .addComponent(jLabel18)
                    .addComponent(jLabel13)
                    .addComponent(jLabel28)
                    .addComponent(jLabel31)
                    .addComponent(jLabel33))
                .addGap(34, 34, 34)
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel10Layout.createSequentialGroup()
                        .addComponent(leanBodyMass_jLabel)
                        .addGap(18, 18, 18)
                        .addComponent(parameter_jLabel15))
                    .addGroup(jPanel10Layout.createSequentialGroup()
                        .addComponent(skeletalMass_jLabel)
                        .addGap(18, 18, 18)
                        .addComponent(parameter_jLabel14))
                    .addComponent(bodyAge_jLabel)
                    .addGroup(jPanel10Layout.createSequentialGroup()
                        .addComponent(bodyFat_jLabel)
                        .addGap(18, 18, 18)
                        .addComponent(parameter_jLabel5))
                    .addGroup(jPanel10Layout.createSequentialGroup()
                        .addComponent(bmr_jLabel)
                        .addGap(18, 18, 18)
                        .addComponent(parameter_jLabel8))
                    .addGroup(jPanel10Layout.createSequentialGroup()
                        .addComponent(totalBodyWater_jLabel)
                        .addGap(18, 18, 18)
                        .addComponent(parameter_jLabel6))
                    .addComponent(nutritionStatus_jLabel)
                    .addGroup(jPanel10Layout.createSequentialGroup()
                        .addComponent(underWeight_jLabel)
                        .addGap(18, 18, 18)
                        .addComponent(parameter_jLabel10))
                    .addGroup(jPanel10Layout.createSequentialGroup()
                        .addComponent(overWeight_jLabel)
                        .addGap(18, 18, 18)
                        .addComponent(parameter_jLabel9)))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel10Layout.setVerticalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel10Layout.createSequentialGroup()
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel13)
                    .addComponent(bodyFat_jLabel)
                    .addComponent(parameter_jLabel5))
                .addGap(18, 18, 18)
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel14)
                    .addComponent(totalBodyWater_jLabel)
                    .addComponent(parameter_jLabel6))
                .addGap(18, 18, 18)
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel15)
                    .addComponent(bmr_jLabel)
                    .addComponent(parameter_jLabel8))
                .addGap(18, 18, 18)
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel16)
                    .addComponent(nutritionStatus_jLabel))
                .addGap(18, 18, 18)
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel17)
                    .addComponent(underWeight_jLabel)
                    .addComponent(parameter_jLabel10))
                .addGap(18, 18, 18)
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel18)
                    .addComponent(overWeight_jLabel)
                    .addComponent(parameter_jLabel9))
                .addGap(18, 18, 18)
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel28, javax.swing.GroupLayout.PREFERRED_SIZE, 27, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(bodyAge_jLabel))
                .addGap(18, 18, 18)
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel31, javax.swing.GroupLayout.PREFERRED_SIZE, 27, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(skeletalMass_jLabel)
                    .addComponent(parameter_jLabel14))
                .addGap(18, 18, 18)
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel33, javax.swing.GroupLayout.PREFERRED_SIZE, 27, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(leanBodyMass_jLabel)
                    .addComponent(parameter_jLabel15)))
        );

        javax.swing.GroupLayout jPanel4Layout = new javax.swing.GroupLayout(jPanel4);
        jPanel4.setLayout(jPanel4Layout);
        jPanel4Layout.setHorizontalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addGap(14, 14, 14)
                .addComponent(jPanel10, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 163, Short.MAX_VALUE)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addComponent(clear_jButton, javax.swing.GroupLayout.PREFERRED_SIZE, 139, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(104, 104, 104)
                        .addComponent(report_jButton, javax.swing.GroupLayout.PREFERRED_SIZE, 139, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(calculate_jButton, javax.swing.GroupLayout.PREFERRED_SIZE, 139, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jPanel11, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap())
        );
        jPanel4Layout.setVerticalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addGap(17, 17, 17)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel10, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addComponent(jPanel11, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel4Layout.createSequentialGroup()
                                .addGap(38, 38, 38)
                                .addComponent(calculate_jButton, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(27, 27, 27)
                                .addComponent(clear_jButton, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(jPanel4Layout.createSequentialGroup()
                                .addGap(72, 72, 72)
                                .addComponent(report_jButton, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)))))
                .addContainerGap(35, Short.MAX_VALUE))
        );

        jPanel7.setBackground(new java.awt.Color(255, 255, 204));
        jPanel7.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED));

        jPanel9.setBackground(new java.awt.Color(255, 255, 204));

        jLabel10.setFont(new java.awt.Font("Yu Gothic UI", 1, 20)); // NOI18N
        jLabel10.setForeground(new java.awt.Color(73, 115, 149));
        jLabel10.setText("BMI :");

        jLabel12.setFont(new java.awt.Font("Yu Gothic UI", 1, 20)); // NOI18N
        jLabel12.setForeground(new java.awt.Color(73, 115, 149));
        jLabel12.setText("Weight :");

        jLabel11.setFont(new java.awt.Font("Yu Gothic UI", 1, 20)); // NOI18N
        jLabel11.setForeground(new java.awt.Color(73, 115, 149));
        jLabel11.setText("Height :");

        height_jLabel.setFont(new java.awt.Font("Comic Sans MS", 1, 18)); // NOI18N
        height_jLabel.setText("n/a");

        weight_jLabel.setFont(new java.awt.Font("Comic Sans MS", 1, 18)); // NOI18N
        weight_jLabel.setText("n/a");

        bmi_jLabel.setFont(new java.awt.Font("Comic Sans MS", 1, 18)); // NOI18N
        bmi_jLabel.setText("n/a");

        parameter_jLabel7.setFont(new java.awt.Font("Comic Sans MS", 1, 18)); // NOI18N
        parameter_jLabel7.setForeground(new java.awt.Color(153, 153, 153));
        parameter_jLabel7.setText("cm");

        parameter_jLabel11.setFont(new java.awt.Font("Comic Sans MS", 1, 18)); // NOI18N
        parameter_jLabel11.setForeground(new java.awt.Color(153, 153, 153));
        parameter_jLabel11.setText("kg");

        parameter_jLabel12.setFont(new java.awt.Font("Comic Sans MS", 1, 18)); // NOI18N
        parameter_jLabel12.setForeground(new java.awt.Color(153, 153, 153));
        parameter_jLabel12.setText("kg/m2");

        javax.swing.GroupLayout jPanel9Layout = new javax.swing.GroupLayout(jPanel9);
        jPanel9.setLayout(jPanel9Layout);
        jPanel9Layout.setHorizontalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel9Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel11)
                .addGap(18, 18, 18)
                .addComponent(height_jLabel)
                .addGap(18, 18, 18)
                .addComponent(parameter_jLabel7)
                .addGap(168, 168, 168)
                .addComponent(jLabel12)
                .addGap(18, 18, 18)
                .addComponent(weight_jLabel)
                .addGap(18, 18, 18)
                .addComponent(parameter_jLabel11)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(jLabel10)
                .addGap(18, 18, 18)
                .addComponent(bmi_jLabel)
                .addGap(18, 18, 18)
                .addComponent(parameter_jLabel12)
                .addGap(59, 59, 59))
        );
        jPanel9Layout.setVerticalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel9Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel10)
                    .addComponent(bmi_jLabel)
                    .addComponent(parameter_jLabel12)))
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                .addComponent(jLabel11)
                .addComponent(height_jLabel)
                .addComponent(jLabel12)
                .addComponent(weight_jLabel)
                .addComponent(parameter_jLabel7)
                .addComponent(parameter_jLabel11))
        );

        javax.swing.GroupLayout jPanel7Layout = new javax.swing.GroupLayout(jPanel7);
        jPanel7.setLayout(jPanel7Layout);
        jPanel7Layout.setHorizontalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel7Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel9, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel7Layout.setVerticalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addGap(15, 15, 15)
                .addComponent(jPanel9, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(17, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, 399, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel7, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel4, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addContainerGap())
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addComponent(jPanel7, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jPanel4, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addGap(6, 6, 6))))
        );

        jLabel5.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/logo.png"))); // NOI18N

        settings_jButton.setBackground(new java.awt.Color(212, 240, 255));
        settings_jButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/settings.png"))); // NOI18N
        settings_jButton.setForeground(new java.awt.Color(212, 240, 255));
        settings_jButton.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        settings_jButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                settings_jButtonActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel8Layout = new javax.swing.GroupLayout(jPanel8);
        jPanel8.setLayout(jPanel8Layout);
        jPanel8Layout.setHorizontalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel8Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(jPanel8Layout.createSequentialGroup()
                        .addComponent(jPanel6, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jPanel3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                    .addGroup(jPanel8Layout.createSequentialGroup()
                        .addComponent(jLabel1)
                        .addGap(18, 18, 18)
                        .addComponent(jLabel5)
                        .addGap(18, 18, 18)
                        .addComponent(jLabel2)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(settings_jButton, javax.swing.GroupLayout.PREFERRED_SIZE, 60, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap())
        );
        jPanel8Layout.setVerticalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel8Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addComponent(jLabel2, javax.swing.GroupLayout.PREFERRED_SIZE, 50, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jLabel5)
                        .addComponent(settings_jButton, javax.swing.GroupLayout.PREFERRED_SIZE, 67, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(jLabel1, javax.swing.GroupLayout.PREFERRED_SIZE, 32, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jPanel3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel6, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 22, Short.MAX_VALUE)
                .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel8, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addComponent(jPanel8, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addContainerGap())
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents
 
    
    
    private void change_jButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_change_jButtonActionPerformed
        // TODO add your handling code here:
         // Create and display a new JFrame (new GUI screen)
          ChangeFrame separateFrame = new ChangeFrame();
                    separateFrame.pack();
                    separateFrame.setLocationRelativeTo(null);
                    separateFrame.setVisible(true);
                    separateFrame.setResizable(false);
                    
                            separateFrame.detailSubmit_jbutton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                hospitalName = separateFrame.detailHospital_textField.getText();
                doctorName = separateFrame.detailDoctor_textField.getText();

                updateMainFrameComponents();

                preferences.put("hospitalName", hospitalName);
                preferences.put("doctorName", doctorName);

                separateFrame.dispose();
            }
        });
    }//GEN-LAST:event_change_jButtonActionPerformed

    
    
    private void connect_jButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_connect_jButtonActionPerformed
    try {
        SerialPort[] portLists = SerialPort.getCommPorts();
        serialPort1 = portLists[comport_jComboBox.getSelectedIndex()];
        serialPort1.setComPortParameters(9600, 8, 1, 0); // Set port parameters
        serialPort1.openPort();

        if (serialPort1.isOpen()) {
            JOptionPane.showMessageDialog(this, serialPort1.getDescriptivePortName() + " Success");
            comport_jComboBox.setEnabled(true);
            connect_jButton.setEnabled(false);
            disconnect_jButton.setEnabled(true);
            isComConnected=true;
            
        outputStream1 = serialPort1.getOutputStream();    
        String dataToSend ="$51,1124,128,#\r\n";
        String dataToSend2 ="$32,1124,1,#\r\n";
        try{
           outputStream1.write(dataToSend.getBytes());
           outputStream1.write(dataToSend2.getBytes());
        }
        catch(IOException e){
            JOptionPane.showMessageDialog(this, e.getMessage());
        }        

            // Create a thread to continuously listen for data
            Thread listenerThread = new Thread(() -> {
                while (serialPort1.isOpen()) {
                    // Read data from the serial port
                    byte[] buffer = new byte[64];
                    int bytesRead = serialPort1.readBytes(buffer, buffer.length);

                    if (bytesRead > 0) {
                        // Convert the received data to a String
                        String receivedData = new String(buffer, 0, bytesRead);
//                        receive_jTextArea.setText(receivedData);

                        // Split the received string by ","
                        String[] strArray = receivedData.split(",");
                        

                        // Check if the first element is "$42" 
                        if ("$42".equals(strArray[0])) {
                            updateGuiWithReceivedData(strArray);
                        }
                        
                        // Check if the first element is "$32" 
                        if ("$51".equals(strArray[0])) {
                            company=strArray[4];
                            phone=strArray[5];
                            model=strArray[6];
                            maxHeight=strArray[7];
                            heightError=strArray[8];
                            weightFactor=strArray[9];
                            weightError=strArray[10];                            
                        }
                    }

                    // Add a delay to avoid excessive CPU usage
                    try {
                        Thread.sleep(100);
                    } catch (InterruptedException e) {
                        e.printStackTrace();
                    }
                }
            });

            listenerThread.start();

        } else {
            JOptionPane.showMessageDialog(this, serialPort1.getDescriptivePortName() + " Failure");
        }
    } catch (ArrayIndexOutOfBoundsException a) {
        JOptionPane.showMessageDialog(this, "Choose COM PORT", "ERROR", ERROR_MESSAGE);
    } catch (Exception b) {
        JOptionPane.showMessageDialog(this, "ERROR", "ERROR", ERROR_MESSAGE);
    }              
    
    }//GEN-LAST:event_connect_jButtonActionPerformed

    private void comport_jComboBoxPopupMenuWillBecomeVisible(javax.swing.event.PopupMenuEvent evt) {//GEN-FIRST:event_comport_jComboBoxPopupMenuWillBecomeVisible
        // TODO add your handling code here:
                comport_jComboBox.removeAllItems();
        SerialPort []portLists = SerialPort.getCommPorts();
        for(SerialPort port : portLists){
            comport_jComboBox.addItem(port.getSystemPortName());
        }
        
    }//GEN-LAST:event_comport_jComboBoxPopupMenuWillBecomeVisible

    private void disconnect_jButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_disconnect_jButtonActionPerformed
        // TODO add your handling code here:
        disconnect_jButton.setEnabled( false );
        if(serialPort1.isOpen()){
            serialPort1.closePort();
            isComConnected = false;
            connect_jButton.setEnabled( true );
        }
    }//GEN-LAST:event_disconnect_jButtonActionPerformed

    private void calculate_jButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_calculate_jButtonActionPerformed
// TODO add your handling code here:

        age=(int) age_jSpinner.getValue();
        calculate();
        bodyFat_jLabel.setText(decimalFormat.format(bodyFat));
        totalBodyWater_jLabel.setText(decimalFormat.format(totalBodyWater));
        bmr_jLabel.setText(Double.toString(bmr));
        underWeight_jLabel.setText(decimalFormat.format(underWeight));
        overWeight_jLabel.setText(decimalFormat.format(overWeight));
        nutritionStatus_jLabel.setText(nutrStatus);
        bodyAge_jLabel.setText(Integer.toString(bodyAge));
        skeletalMass_jLabel.setText(Double.toString(skeletalMass));
        leanBodyMass_jLabel.setText(Double.toString(leanBodyMass));
        
        
                calculate_jButton.setEnabled(false);
                report_jButton.setEnabled(true);
                saveDataFile();
    }//GEN-LAST:event_calculate_jButtonActionPerformed

    private void male_buttonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_male_buttonActionPerformed
        // TODO add your handling code here:
        male_button.setBackground(Color.decode("#6c63ff"));
         male_button.setForeground(Color.WHITE);
                female_button.setBackground(Color.WHITE);
                female_button.setForeground(Color.BLACK);
                gender="Male";
    }//GEN-LAST:event_male_buttonActionPerformed

    private void female_buttonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_female_buttonActionPerformed
        // TODO add your handling code here:
         female_button.setBackground(Color.decode("#6c63ff"));
         female_button.setForeground(Color.WHITE);
         male_button.setBackground(Color.WHITE);
         male_button.setForeground(Color.BLACK);
         gender="Female";
    }//GEN-LAST:event_female_buttonActionPerformed

    private void submit_jButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_submit_jButtonActionPerformed
        // TODO add your handling code here:
                if (!name_jTextField.getText().isEmpty() && !age_jSpinner.getValue().toString().equals("0") && !gender.isEmpty()) {
                    
//                            outputStream1 = serialPort1.getOutputStream();    
//        String dataToSend3 ="$22,1,1,89.0,174,0,#\r\n";
//        try{
//           outputStream1.write(dataToSend3.getBytes());
//        }
//        catch(IOException e){
//            JOptionPane.showMessageDialog(this, e.getMessage());
//        } 
                    
                name = name_jTextField.getText();
                String age_val = age_jSpinner.getValue().toString();
                age=Integer.parseInt(age_val);
                
                      calculate_jButton.setEnabled(true);
                      submit_jButton.setEnabled(false);
                      
                      
                } else {
                    JOptionPane.showMessageDialog(this, "Please fill in all required fields.", "Error", JOptionPane.ERROR_MESSAGE);
                }
    }//GEN-LAST:event_submit_jButtonActionPerformed

    private void clear_jButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_clear_jButtonActionPerformed
        bodyFat_jLabel.setText("n/a");
        totalBodyWater_jLabel.setText("n/a");
        bmr_jLabel.setText("n/a");
        underWeight_jLabel.setText("n/a");
        overWeight_jLabel.setText("n/a");
        nutritionStatus_jLabel.setText("n/a");
        bodyAge_jLabel.setText("n/a");
        skeletalMass_jLabel.setText("n/a");
        leanBodyMass_jLabel.setText("n/a");
        
        spo2_jSlider.setValue(0);
        heartRate_jSlider.setValue(0);
        systolicPressure_jTextField.setText("");
        diastolicPressure_jTextField.setText("");
        
        name_jTextField.setText("");
        age_jSpinner.setValue(0);
        male_button.setBackground(Color.WHITE);
        male_button.setForeground(Color.BLACK);
        female_button.setBackground(Color.WHITE);
        female_button.setForeground(Color.BLACK);
        
        submit_jButton.setEnabled(true);
        calculate_jButton.setEnabled(false);
        report_jButton.setEnabled(false);
//        calculate_jButton.setEnabled(true);
    }//GEN-LAST:event_clear_jButtonActionPerformed

    private void report_jButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_report_jButtonActionPerformed
        // TODO add your handling code here:
        if (!systolicPressure_jTextField.getText().isEmpty() && !diastolicPressure_jTextField.getText().isEmpty()) {
        generateAndDownloadHTMLReport();
        report_jButton.setEnabled(false);
        } else{
            JOptionPane.showMessageDialog(this, "Please fill in all required fields.", "Error", JOptionPane.ERROR_MESSAGE);
        }
    }//GEN-LAST:event_report_jButtonActionPerformed

    private void settings_jButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_settings_jButtonActionPerformed
        // TODO add your handling code here:
        if(isComConnected){
                  ConfigureFrame separateFrame2 = new ConfigureFrame();
                    separateFrame2.pack();
                    separateFrame2.setLocationRelativeTo(null);
                    separateFrame2.setVisible(true);
                    separateFrame2.setResizable(false);
                            separateFrame2.configureCompany_jTextField.setText(company);
                            separateFrame2.configurePhone_jTextField.setText(phone);
                            separateFrame2.configureModel_jTextField.setText(model);
                            separateFrame2.configureMaxHeight_jTextField.setText(maxHeight);
                            separateFrame2.configureHeightError_jTextField.setText(heightError);
                            separateFrame2.configureWeightFactor_jTextField.setText(weightFactor);
                            separateFrame2.configureWeightError_jTextField.setText(weightError);
                    
            separateFrame2.configureUpdate_jButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
          outputStream1 = serialPort1.getOutputStream();    
        String dataToSend3 ="$31,"+separateFrame2.configureCompany_jTextField.getText()+","+separateFrame2.configurePhone_jTextField.getText()+","+separateFrame2.configureModel_jTextField.getText()+","+separateFrame2.configureMaxHeight_jTextField.getText()+","+separateFrame2.configureHeightError_jTextField.getText()+","+separateFrame2.configureWeightFactor_jTextField.getText()+","+","+separateFrame2.configureWeightError_jTextField.getText()+",#\r\n";
        try{
           outputStream1.write(dataToSend3.getBytes());
        }
        catch(IOException e){
            e.printStackTrace();
        }
        serialPort1.closePort();
            isComConnected = false;
            connect_jButton.setEnabled( true );
            disconnect_jButton.setEnabled( false );
                separateFrame2.dispose();
            }
        });
                   
                  
        }else{
            JOptionPane.showMessageDialog(this, "COM PORT not Connected", "ERROR", ERROR_MESSAGE);
        }     
        
    }//GEN-LAST:event_settings_jButtonActionPerformed

    private void spo2_jSliderStateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_spo2_jSliderStateChanged
        // TODO add your handling code here:
        spo2Val_jLabel.setText(String.valueOf(spo2_jSlider.getValue()));
    }//GEN-LAST:event_spo2_jSliderStateChanged

    private void heartRate_jSliderStateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_heartRate_jSliderStateChanged
        // TODO add your handling code here:
        heartRateVal_jLabel.setText(String.valueOf(heartRate_jSlider.getValue()));
    }//GEN-LAST:event_heartRate_jSliderStateChanged

    /**
     * @param args the command line arguments
     */
    
    
    private void updateGuiWithReceivedData(String[] strArray) {
    if (strArray.length >= 7) {
        height_jLabel.setText(strArray[4]);
        weight_jLabel.setText(strArray[5]);
        bmi_jLabel.setText(strArray[6]);

        height = Integer.parseInt(strArray[4]);
        weight = Double.parseDouble(strArray[5]);
        bmi = Double.parseDouble(strArray[6]);
    }
}
    
    

private void updateMainFrameComponents() {
    hospitalNameLabel.setText("Hospital Name: " + hospitalName);
    doctorNameLabel.setText("Doctor Name: " + doctorName);
    
    // Update the corresponding JLabel components in the main frame
    hospital_jLabel.setText(hospitalName);
    doctor_jLabel.setText(doctorName);
}
    
    
    
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JSpinner age_jSpinner;
    private javax.swing.JLabel bmi_jLabel;
    private javax.swing.JLabel bmr_jLabel;
    private javax.swing.JLabel bodyAge_jLabel;
    private javax.swing.JLabel bodyFat_jLabel;
    private javax.swing.JButton calculate_jButton;
    private javax.swing.JButton change_jButton;
    private javax.swing.JButton clear_jButton;
    private javax.swing.JComboBox<String> comport_jComboBox;
    private javax.swing.JButton connect_jButton;
    private javax.swing.JTextField diastolicPressure_jTextField;
    private javax.swing.JButton disconnect_jButton;
    private javax.swing.JLabel doctor_jLabel;
    private java.awt.Button female_button;
    private javax.swing.JLabel heartRateVal_jLabel;
    private javax.swing.JSlider heartRate_jSlider;
    private javax.swing.JLabel height_jLabel;
    private javax.swing.JLabel hospital_jLabel;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel13;
    private javax.swing.JLabel jLabel14;
    private javax.swing.JLabel jLabel15;
    private javax.swing.JLabel jLabel16;
    private javax.swing.JLabel jLabel17;
    private javax.swing.JLabel jLabel18;
    private javax.swing.JLabel jLabel19;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel20;
    private javax.swing.JLabel jLabel21;
    private javax.swing.JLabel jLabel22;
    private javax.swing.JLabel jLabel23;
    private javax.swing.JLabel jLabel25;
    private javax.swing.JLabel jLabel26;
    private javax.swing.JLabel jLabel27;
    private javax.swing.JLabel jLabel28;
    private javax.swing.JLabel jLabel29;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel30;
    private javax.swing.JLabel jLabel31;
    private javax.swing.JLabel jLabel32;
    private javax.swing.JLabel jLabel33;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel10;
    private javax.swing.JPanel jPanel11;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JPanel jPanel7;
    private javax.swing.JPanel jPanel8;
    private javax.swing.JPanel jPanel9;
    private javax.swing.JLabel leanBodyMass_jLabel;
    private java.awt.Button male_button;
    private javax.swing.JTextField name_jTextField;
    private javax.swing.JLabel nutritionStatus_jLabel;
    private javax.swing.JLabel overWeight_jLabel;
    private javax.swing.JLabel parameter_jLabel1;
    private javax.swing.JLabel parameter_jLabel10;
    private javax.swing.JLabel parameter_jLabel11;
    private javax.swing.JLabel parameter_jLabel12;
    private javax.swing.JLabel parameter_jLabel14;
    private javax.swing.JLabel parameter_jLabel15;
    private javax.swing.JLabel parameter_jLabel2;
    private javax.swing.JLabel parameter_jLabel3;
    private javax.swing.JLabel parameter_jLabel4;
    private javax.swing.JLabel parameter_jLabel5;
    private javax.swing.JLabel parameter_jLabel6;
    private javax.swing.JLabel parameter_jLabel7;
    private javax.swing.JLabel parameter_jLabel8;
    private javax.swing.JLabel parameter_jLabel9;
    private javax.swing.JButton report_jButton;
    private javax.swing.JButton settings_jButton;
    private javax.swing.JLabel skeletalMass_jLabel;
    private javax.swing.JLabel spo2Val_jLabel;
    private javax.swing.JSlider spo2_jSlider;
    private javax.swing.JButton submit_jButton;
    private javax.swing.JTextField systolicPressure_jTextField;
    private javax.swing.JLabel totalBodyWater_jLabel;
    private javax.swing.JLabel underWeight_jLabel;
    private javax.swing.JLabel weight_jLabel;
    // End of variables declaration//GEN-END:variables
  
    
    
        public void calculate() {
            
        if (height != 0.0 && age != 0) {
            bodyFat = (double)((double)1.20f * bmi) + (double)((double)0.23f * age);

            if (gender.equalsIgnoreCase("Male")) {
                bodyFat -= 16.2f;
                totalBodyWater = (double)((double)2.447f - (double)((double)0.09156f * age) + (double)((double)0.1074f * height) + (double)((double)0.3362f * weight));
                totalBodyWater = (totalBodyWater * 100.0f / weight);
            }

            if (gender.equalsIgnoreCase("Female")) {
                bodyFat -= 5.4f;
                totalBodyWater = (double)((double)-2.097f + (double)((double)0.1069f * height) + (double)((double)0.2466f * weight));
                totalBodyWater = (totalBodyWater * 100.0f / weight);
            }

            bmr = (double)(370.0f + (double)(21.6f * ((double)1 - (double)(bodyFat/100.0f)) * weight));
            bmr=Math.round(bmr);
            
            leanBodyMass = (double)((double)weight - (double)((double)(weight * bodyFat)/100));
            leanBodyMass=Math.round(leanBodyMass);
            
            double metabolicAge;
            if (gender.equalsIgnoreCase("Male")) {
                 metabolicAge=(double)(((double)88.362f + ((double)13.397f * (double)weight) + (double)((double)4.799f * height)) - bmr)/(double)5.677f;
                 skeletalMass= (0.407 * weight) + (0.267 * height) - 19.2;
            } else{
                metabolicAge= (double)(((double)447.593f + ((double)9.247f * (double)weight) + (double)((double)3.098f * height)) - bmr)/(double)4.33f;
                skeletalMass= (0.252  * weight) + (0.473  * height) - 48.3;
            }
            bodyAge=(int)Math.round(metabolicAge);
            skeletalMass=Math.round(skeletalMass);
        }

        if (bmi < minThreshold && height != 0.0) {
            heightMtrValue = height / 100;
            heightMtrValue *= heightMtrValue;
            if (heightMtrValue != 0) {
                underWeight = (minThreshold - bmi) * heightMtrValue;
                nutrition = nutrStatus + ":" + underWeight;
            }
        }
        if (bmi > maxThreshold && height != 0.0) {
            heightMtrValue = height / 100;
            heightMtrValue *= heightMtrValue;
            if (heightMtrValue != 0) {
                overWeight = (bmi - maxThreshold) * heightMtrValue;
                nutrition = nutrStatus + ":" + overWeight;
            }
        }
        
        if (Math.round(bmi) < 18) {
            nutrStatus = "UNDERWEIGHT";
        } else if (Math.round(bmi) <= 25) {
            nutrStatus = "NORMAL";
        } else if (Math.round(bmi) <= 30) {
            nutrStatus = "OVERWEIGHT";
        } else if (Math.round(bmi) > 30) {
            nutrStatus = "OBESE";
        }
    }
        
        
public static String generateInvoiceNumber() {

String currentInvoiceNumber="CT"+currentDate3;

return currentInvoiceNumber;
}

    
        private void generateAndDownloadHTMLReport() {
            invoice=generateInvoiceNumber();
          
            spo2=Integer.toString(spo2_jSlider.getValue());
            heartRate=Integer.toString(heartRate_jSlider.getValue());
            systolicPressure=systolicPressure_jTextField.getText();
            diastolicPressure=diastolicPressure_jTextField.getText();
            

        String htmlContent =  "<!DOCTYPE html>\n" +
                "<html lang=\"en\">\n" +
                "<head>\n" +
                "    <meta charset=\"UTF-8\" />\n" +
                "    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\" />\n" +
                "    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n" +
                "    <title>Cowin BMI Report</title>\n" +
                "    <style>\n" +
                "        @media print {\n" +
                "            @page {\n" +
                "                size: A4;\n" +
                "            }\n" +
                "        }\n" +
                "        body {\n" +
                "            height: auto;\n" +
                "            width: auto;\n" +
                "            margin-top: 40px;\n" +
                "            padding: 0;\n" +
                "            padding-left: 20px;\n" +
                "            padding-right: 20px;\n" +
                "            box-sizing: border-box;\n" +
                "        }\n" +
                "    </style>\n" +
                "</head>\n" +
                "<body>\n" +
                "    <header id=\"header\" style=\" margin-top: 150px;\n" +
                "    height: 120px;\n" +
                "    width: 210mm;\n" +
                "    box-sizing: border-box;\n" +
                "    display: flex;\n" +
                "    flex-direction: column;\n" +
                "    align-items: center;\">\n" +
                "        <div style=\"height:100px;width:100px; position: absolute;left:570px; top:0px ;border:1px solid;\">\n" +
                "            <img src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAb0ElEQVR4nO2dBbRdtRKG771t0WItWqS4u7u7FXcpbsXd3R2KU7S4u7QUdytQHFoolOKulbPf+rLuv9ecNNly7r4P+h5Za3puz8lOJplkMvlnkt2U/Jv+UamJf2q1WqLPUaNGtTuNHj06rY/E/xstq2Z4V4qVG8prE99XwVNb+HcCyWKyvVJe55RJoTKyOr2R8toz2frqZsi3336bPPLII8mjjz7aLtSvX7/kwQcfTAYOHOjq00x5++233ff9+vUrVR68/vDDD2M0SuV+/vnnyQMPPJD0798/efjhh5Mvv/xyjLx+x+i3d999tyGeyvTFQw89lHzxxRd1PDmBMHVINLCpqandqUePHq6+v/76y3327Nmz4bKeeeaZxLaBNGLECPd52WWXuTzNzc3u89Zbb3Xfjxw5MioQlbPHHnv8V/ri2muvreOpTiBIzjagpaUl6dixYyVEeR06dHCfG2+8cZ1AdtllF/f9uOOOm1sOPFken3rqKVfGn3/+6QQB/f7773UCGWeccdzn7bffXlggvXr1quO5qn5QeWrH9ddfny8Q2+AqKSaQLbbYolQ5zYa3t956K4mlG2+8sTKBVEnwX0ogyrzeeuslF110UXLmmWcmZ511VkN03nnnJccee2wy3njjpR250UYb1TGBqjzllFOSc845J1rOGWeckVx88cXJqquuWscjwjz00EOT/fbbLznggAMc8fcRRxyRrLbaanWdWkYge+21V92zhx9+eHL++ec33Bfif+utt05nXGGBKDPCqCL9+uuvyaSTTpqOEAnEmn1F04knnlhq5DIINBDaIpCvvvoqqSLddddddbO2lEAYDdLPPFCWtLh+9tlnySSTTBIUiD7zyvrjjz9cXkaq7ShmCn+HyF9v2iKQ9957L1WzjfSF+EcADQuEqabMMgnLkMxPTLuYQIqWNaJVuEceeWRp3V6FQD788MPSPIf4v+GGG6oTyJZbbpnMOeecySKLLJIstNBCQVp44YWT+eabL3nyySfThuYJRJ1BQohrrbWWK2PuuedOdtxxR/d9TCBXX32128e8+eabrsNZq9pTICQMCfpgwQUXdO0N9QO/zzPPPMm6666b/Pzzz+ngrFQgCKPoqERXNiqQ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'/>\n" +
                "        </div>\n" +
                "        <p style=\"width: 280px; height:20px; font-weight:600; font-size:16px; font-style:normal; margin-left:180px; text-align:center; padding-top:2px; border:2px solid; box-shadow: 3px 3px;\"> COWIN BMI200X TEST REPORT\n" +
                "        </p>\n" +
                "        <p style=\" font-weight:600; font-size:16px; font-style:normal;text-align:center;margin-top:0px ;\">Invoice : ${invoice}</p>\n" +
                "        <div style=\"height:15px; position: absolute;left:120px; margin-top:5px ;font-weight:400; font-size:16px; font-style:normal;\">\n" +
                "            <p style=\"display: inline;\">Name<span lang=\"te\">&#3072;&#3127;</span></p>\n" +
                "            <p style=\"display: inline; margin-left:20px\">:</p>\n" +
                "            <p style=\"display: inline;margin-left:5px\">${name}</p>\n" +
                "        </div>\n" +
                "        <div style=\"height:15px; position: absolute;left:120px; margin-top:40px;font-weight:400; font-size:16px; font-style:normal;\">\n" +
                "            <p style=\"display: inline;\">Age</p>\n" +
                "            <p style=\"display: inline;margin-left:31px\">:</p>\n" +
                "            <p style=\"display: inline;margin-left:5px\">${age}</p>\n" +
                "        </div>\n" +
                "        <div style=\"height:15px; position: absolute;left:400px; margin-top:5px;font-weight:400; font-size:16px; font-style:normal;\">\n" +
                "            <p style=\"display: inline;\">Date / Time</p>\n" +
                "            <p style=\"display: inline; margin-left:20px\">:</p>\n" +
                "            <p style=\"display: inline;margin-left:5px\">${date}</p>\n" +
                "        </div>\n" +
                "        <div style=\"height:15px; position: absolute;left:400px; margin-top:40px;font-weight:400; font-size:16px; font-style:normal;\">\n" +
                "            <p style=\"display: inline;\">Gender</p>\n" +
                "            <p style=\"display: inline;margin-left:48px\">:</p>\n" +
                "            <p style=\"display: inline;margin-left:5px\">${gender}</p>\n" +
                "        </div>\n" +
                "    </header>\n" +
                "    <hr style=\"border: 1px solid black;margin-top:77px ;\"></hr>\n" +
                "    <main>\n" +
                "        <section id=\"outer-container\" style=\" height: 800px; width: 210mm;display: flex;flex-direction: column;box-sizing: border-box;\">\n" +
                "            <p style=\" height:20px; margin-top:10px; font-weight:600; font-size:16px; font-style:normal;text-align:center; text-decoration:underline\">COMPLETE BMI REPORT\n" +
                "            </p>\n" +
                "            <div style=\"height:15px; position: absolute;left:80px; margin-top:2px;font-weight:600; font-size:16px; font-style:normal;\">\n" +
                "                <p style=\"display: inline;\">PARAMETER NAME</p>\n" +
                "                <p style=\"display: inline;margin-left:100px;\">RESULT</p>\n" +
                "                <p style=\"display: inline;margin-left:100px;\">REFERENCE RANGE\n" +
                "                </p>\n" +
                "            </div>\n" +
                "            <div style=\"height:15px; margin-left: 80px; margin-top:15px;font-weight:400; font-size:16px; font-style:normal;\">\n" +
                "                <p style=\"width:180px; display: inline-block;\">Height</p>\n" +
                "                <p style=\"width:180px; display: inline-block;margin-left:50px;font-weight:${height_font};\">: ${height}</p>\n" +
                "                <p style=\"display: inline;font-size:14px;margin-left:0px\">(50-200)cm\n" +
                "                </p>\n" +
                "            </div>\n" +
                "            <div style=\"height:15px; margin-left: 80px; margin-top:15px;font-weight:400; font-size:16px; font-style:normal;\">\n" +
                "                <p style=\"width:180px; display: inline-block;\">Weight</p>\n" +
                "                <p style=\"width:180px; display: inline-block;margin-left:50px;font-weight:${weight_font};\">: ${weight}</p>\n" +
                "                <p style=\"display: inline;font-size:14px;margin-left:0px\">(10-150)kg\n" +
                "                </p>\n" +
                "            </div>\n" +
                    "<div style=\"height:15px; margin-left: 80px; margin-top:15px;font-weight:400; font-size:16px; font-style:normal;\">\n" +
                "    <p style=\"width:180px; display: inline-block;\">BMI</p>\n" +
                "    <p style=\"width:180px; display: inline-block;margin-left:50px;font-weight:${bmi_font};\">: ${bmi}</p>\n" +
                "    <p style=\"display: inline;font-size:14px;margin-left:0px\">(18-25) kg/m2\n" +
                "    </p>\n" +
                "</div>\n" +
                "<div style=\"height:15px; margin-left: 80px; margin-top:15px;font-weight:400; font-size:16px; font-style:normal;\">\n" +
                "    <p style=\"width:180px; display: inline-block;\">Bodyfat</p>\n" +
                "    <p style=\"width:180px; display: inline-block;margin-left:50px;font-weight:${bodyFat_font};\">: ${bodyFat}</p>\n" +
                "    <p style=\"display: inline;font-size:14px;margin-left:0px\">(21-33)%\n" +
                "    </p>\n" +
                "</div>\n" +
                "<div style=\"height:15px; margin-left: 80px; margin-top:15px;font-weight:400; font-size:16px; font-style:normal;\">\n" +
                "    <p style=\"width:180px; display: inline-block;\">Total Body Water</p>\n" +
                "    <p style=\"width:180px; display: inline-block;margin-left:50px;font-weight:${totalBodyWater_font};\">: ${totalBodyWater}</p>\n" +
                "    <p style=\"display: inline;font-size:14px;margin-left:0px\">(50-66)%\n" +
                "    </p>\n" +
                "</div>\n" +
                "<div style=\"height:15px; margin-left: 80px; margin-top:15px;font-weight:400; font-size:16px; font-style:normal;\">\n" +
                "    <p style=\"width:180px; display: inline-block;\">BMR </p>\n" +
                "    <p style=\"width:180px; display: inline-block;margin-left:50px;font-weight:${bmr_font};\">: ${bmr}</p>\n" +
                "    <p style=\"display: inline;font-size:14px;margin-left:0px\">(1170-2440) cal/day\n" +
                "    </p>\n" +
                "</div>\n" +
                "<div style=\"height:15px; margin-left: 80px; margin-top:15px;font-weight:600; font-size:16px; font-style:normal;\">\n" +
                "    <p style=\"width:180px; display: inline-block;\">Nutrition Status</p>\n" +
                "    <p style=\"width:180px; display: inline-block;margin-left:50px;\">: ${nutrtitionStatus}</p>\n" +
                "    <p style=\"display: inline;font-size:14px;margin-left:0px\">\n" +
                "    </p>\n" +
                "</div>\n" +
                "<div style=\"height:15px; margin-left: 80px; margin-top:15px;font-weight:400; font-size:16px; font-style:normal;\">\n" +
                "    <p style=\"width:180px; display: inline-block;\">Over weight</p>\n" +
                "    <p style=\"width:180px; display: inline-block;margin-left:50px;font-weight:600;\">: ${overWeight}</p>\n" +
                "    <p style=\"display: inline;font-size:14px;margin-left:0px\">\n" +
                "    kg</p>\n" +
                "</div>\n" +
                "<div style=\"height:15px; margin-left: 80px; margin-top:15px;font-weight:400; font-size:16px; font-style:normal;\">\n" +
                "    <p style=\"width:180px; display: inline-block;\">Under weight</p>\n" +
                "    <p style=\"width:180px; display: inline-block;margin-left:50px;font-weight:600;\">: ${underWeight}</p>\n" +
                "    <p style=\"display: inline;font-size:14px;margin-left:0px\">\n" +
                "    kg</p>\n" +
                "</div>\n" +
                "<div style=\"height:15px; margin-left: 80px; margin-top:15px;font-weight:400; font-size:16px; font-style:normal;\">\n" +
                "    <p style=\"width:180px; display: inline-block;\">SPO2</p>\n" +
                "    <p style=\"width:180px; display: inline-block;margin-left:50px;font-weight:${spo2_font};\">: ${spo2}</p>\n" +
                "    <p style=\"display: inline;font-size:14px;margin-left:0px\">(95-100)%\n" +
                "    </p>\n" +
                "</div>\n" +
                "<div style=\"height:15px; margin-left: 80px; margin-top:15px;font-weight:400; font-size:16px; font-style:normal;\">\n" +
                "    <p style=\"width:180px; display: inline-block;\">Heartrate</p>\n" +
                "    <p style=\"width:180px; display: inline-block;margin-left:50px;font-weight:${heartRate_font};\">: ${heartRate}</p>\n" +
                "    <p style=\"display: inline;font-size:14px;margin-left:0px\">(60-100)bpm\n" +
                "    </p>\n" +
                "</div>\n" +
                "<div style=\"height:15px; margin-left: 80px; margin-top:20px;font-weight:400; font-size:16px; font-style:normal;\">\n" +
                "    <p style=\"width:180px; display: inline-block;\">SYS</p>\n" +
                "    <p style=\"width:180px; display: inline-block;margin-left:50px;font-weight:${systolicPressure_font};\">: ${systolicPressure}</p>\n" +
                "    <p style=\"display: inline;font-size:14px;margin-left:0px\">(120)mmHg\n" +
                "    </p>\n" +
                "</div>\n" +
                "<div style=\"height:15px; margin-left: 80px; margin-top:15px;font-weight:400; font-size:16px; font-style:normal;\">\n" +
                "    <p style=\"width:180px; display: inline-block;\">DIA</p>\n" +
                "    <p style=\"width:180px; display: inline-block;margin-left:50px;font-weight:${diastolicPressure_font};\">: ${diastolicPressure}</p>\n" +
                "    <p style=\"display: inline;font-size:14px;margin-left:0px\">(80)mmHg\n" +
                "    </p>\n" +
                "</div>\n" +
                "<div style=\"height:15px; margin-left: 80px; margin-top:15px;font-weight:400; font-size:16px; font-style:normal;\">\n" +
                "    <p style=\"width:180px; display: inline-block;\">Body Age</p>\n" +
                "    <p style=\"width:180px; display: inline-block;margin-left:50px;\">: ${bodyAge}</p>\n" +
                "    <p style=\"display: inline;font-size:14px;margin-left:0px\">\n" +
                "    </p>\n" +
                "</div>\n" +
                "<div style=\"height:15px; margin-left: 80px; margin-top:15px;font-weight:400; font-size:16px; font-style:normal;\">\n" +
                "    <p style=\"width:180px; display: inline-block;\">Skeletal Mass</p>\n" +
                "    <p style=\"width:180px; display: inline-block;margin-left:50px;\">: ${skeletalMass}</p>\n" +
                "    <p style=\"display: inline;font-size:14px;margin-left:0px\">kg\n" +
                "    </p>\n" +
                "</div>\n" +
                "<div style=\"height:15px; margin-left: 80px; margin-top:15px;font-weight:400; font-size:16px; font-style:normal;\">\n" +
                "    <p style=\"width:180px; display: inline-block;\">Lean Body Mass</p>\n" +
                "    <p style=\"width:180px; display: inline-block;margin-left:50px;\">: ${leanBodyMass}</p>\n" +
                "    <p style=\"display: inline;font-size:14px;margin-left:0px\">kg\n" +
                "    </p>\n" +
                "</div>\n" +
                "<div style=\"height:auto; margin-left: 80px; margin-top:15px;font-weight:400; font-size:16px; font-style:normal;\">\n" +
                "    <p style=\"width:180px; display: inline-block;position:absolute;margin-top:20px; margin-left: 108px;\">Recommendation</p>\n" +
                "    <p style=\"width: 350px; display: inline-block;margin-left:234px;line-height:20px\">: Choose Minimally porcessed, whole foods, whole grains, vegetables, fruits, nuts, healthful sources of protein (fish, poultry, beans) and plant oils.</p>\n" +
                "</div>\n" +
                "            <div style=\"width: 600px;height:auto; margin-left: 80px; margin-top:13px;font-weight:400; font-size:14px; position:relative;font-style:normal;\">\n" +
                "                <p style=\"display: inline-block;height:auto; position:relative;\"><span style=\"font-weight:600;line-height: 24px;\">Disclaimer</span><br></br>Please contact a dietician for health weight loss or gain weight.<br></br>**** This is a computer generated report with over 96% accuracy and Please consult\n" +
                "                    physician or other health care profession for further guidance.<br></br><br></br>*T&#38;C</p>\n" +
                "            </div>\n" +
                "        </section>\n" +
                "    </main>\n" +
                "</body>\n" +
        "</html>";
        
         htmlContent = htmlContent
                 .replace("${invoice}",invoice)
                 .replace("${name}",name)
                 .replace("${age}",Double.toString(age))
                 .replace("${gender}",gender)
                 .replace("${date}",currentDate)
                 .replace("${height}",Double.toString(height))
                 .replace("${weight}",Double.toString(weight))
                 .replace("${bmi}",Double.toString(bmi))
                 .replace("${bodyFat}",decimalFormat.format(bodyFat))
                 .replace("${totalBodyWater}",decimalFormat.format(totalBodyWater))
                 .replace("${bmr}",Double.toString(bmr))
                 .replace("${nutrtitionStatus}",nutrStatus)
                 .replace("${overWeight}",decimalFormat.format(overWeight))
                 .replace("${underWeight}",decimalFormat.format(underWeight))
                 .replace("${spo2}",spo2)
                 .replace("${heartRate}",heartRate)
                 .replace("${systolicPressure}",systolicPressure)
                 .replace("${diastolicPressure}",diastolicPressure)
                 .replace("${bodyAge}",Integer.toString(bodyAge))
                 .replace("${skeletalMass}",decimalFormat.format(skeletalMass))
                 .replace("${leanBodyMass}",decimalFormat.format(leanBodyMass))
                 
                 
                 .replace("${height_font}",getFontWeight("height"))
                 .replace("${weight_font}",getFontWeight("weight"))
                 .replace("${bmi_font}",getFontWeight("bmi"))
                 .replace("${totalBodyWater_font}",getFontWeight("totalBodyWater"))
                 .replace("${bmr_font}",getFontWeight("bmr"))
                 .replace("${bodyFat_font}",getFontWeight("bodyFat"))
                 .replace("${spo2_font}",getFontWeight("spo2"))
                 .replace("${heartRate_font}",getFontWeight("heartRate"))
                 .replace("${systolicPressure_font}",getFontWeight("systolicPressure"))
                 .replace("${diastolicPressure_font}",getFontWeight("diastolicPressure"));
                

                  
        String mainDrive;
        String osSysstem = System.getProperty("os.name").toLowerCase();
        if (osSysstem.contains("win")) {
            // Windows system
            mainDrive = "C:";
        } else {
            // Assume other systems (Unix-based) use the root directory
            mainDrive = "/";
        }
        
        
        // Specify the folder name and file name
        String folderName = "CoWinBMI";
        String subFolderName = "reports";

        // Create the full path to the folder
        String folderPath = mainDrive + File.separator + folderName+File.separator +subFolderName;

        // Check if the folder exists, and create it if it doesn't
        File folder = new File(folderPath);
        if (!folder.exists()) {
            if (folder.mkdirs()) {
                System.out.println("Folder created: " + folderPath);
            } else {
                System.err.println("Failed to create folder: " + folderPath);
                return;
            }
        } else {
            System.out.println("Folder already exists: " + folderPath);
        }
         
//        String userHomeDirectory = System.getProperty("user.home");
        String filePath = folderPath + File.separator + name+"_"+currentDate2 +".pdf";

        try {
            // Create a temporary HTML file
            File htmlFile = File.createTempFile("report", ".html");
            BufferedWriter writer = new BufferedWriter(new FileWriter(htmlFile));
            writer.write(htmlContent);
            writer.close();

            // Create a temporary PDF file
             File pdfFile = new File(filePath);

            // Convert HTML to PDF using Flying Saucer (iTextRenderer)
            try (OutputStream os = new FileOutputStream(pdfFile)) {
                ITextRenderer renderer = new ITextRenderer();
                renderer.setDocumentFromString(htmlContent);
//                renderer.setDocument(htmlFile.toURI().toURL().toString());
                renderer.layout();
                renderer.createPDF(os);
            }

            // Open the PDF file for viewing
            Desktop.getDesktop().open(pdfFile);
        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, "Error generating the PDF: " + e.getMessage(), "Error", JOptionPane.ERROR_MESSAGE);
        }      
    }
       
         public  String getFontWeight(String parameter){
             
             switch (parameter) {
            case "height":
                if(height>=50 && height<=200){
                    return "400";
                }else{
                    return "600";
                }
            case "weight":
                if(weight>=10 && weight<=150){
                    return "400";
                }else{
                    return "600";
                }
            case "bmi":
                if(bmi>=18 && bmi<=25){
                    return "400";
                }else{
                    return "600";
                }
            case "bodyFat":
                if(bodyFat>=21 && bodyFat<=33){
                    return "400";
                }else{
                    return "600";
                }
            case "totalBodyWater":
                if(totalBodyWater>=50 && totalBodyWater<=66){
                    return "400";
                }else{
                    return "600";
                }
            case "bmr":
                if(bmr>=1170 && bmr<=2440){
                    return "400";
                }else{
                    return "600";
                }
            case "spo2":
                if(Integer.parseInt(spo2)>=95 && Integer.parseInt(spo2)<=100){
                    return "400";
                }else{
                    return "600";
                }
            case "heartRate":
                if(Integer.parseInt(spo2)>=60 && Integer.parseInt(spo2)<=100){
                    return "400";
                }else{
                    return "600";
                }
            case "systolicPressure":
                if(Integer.parseInt(systolicPressure)>=90 && Integer.parseInt(systolicPressure)<=120){
                    return "400";
                }else{
                    return "600";
                }
            case "diastolicPressure":
                if(Integer.parseInt(diastolicPressure)>=60 && Integer.parseInt(diastolicPressure)<=80){
                    return "400";
                }else{
                    return "600";
                }   
            default:
                return "400";
        }
             
         }
        

        
     private void saveDataFile() {
         
        String mainDrive;
        String os = System.getProperty("os.name").toLowerCase();
        if (os.contains("win")) {
            // Windows system
            mainDrive = "C:";
        } else {
            // Assume other systems (Unix-based) use the root directory
            mainDrive = "/";
        }
        
        
        // Specify the folder name and file name
        String folderName = "CoWinBMI";
        String fileName = "userData.json";

        // Create the full path to the folder
        String folderPath = mainDrive + File.separator + folderName;

        // Check if the folder exists, and create it if it doesn't
        File folder = new File(folderPath);
        if (!folder.exists()) {
            if (folder.mkdirs()) {
                System.out.println("Folder created: " + folderPath);
            } else {
                System.err.println("Failed to create folder: " + folderPath);
                return;
            }
        } else {
            System.out.println("Folder already exists: " + folderPath);
        }

        // Specify the new data as a JSON object
        JSONObject newData = new JSONObject();
        newData.put("Invoice", generateInvoiceNumber()); 
        newData.put("Date", currentDate); 
        newData.put("Name", name); 
        newData.put("Age", age); 
        newData.put("Gender", gender);
        newData.put("Height", height); 
        newData.put("Weight", weight);
        newData.put("BMI", bmi); 
        newData.put("Body Fat", bodyFat);
        newData.put("Total Body Water", totalBodyWater); 
        newData.put("BMR", bmr);
        newData.put("Nutrition Status", nutrStatus); 
        newData.put("Over weight", overWeight);
        newData.put("Under weight", underWeight); 
        newData.put("SPO2",spo2_jSlider.getValue());
        newData.put("Heartrate", heartRate_jSlider.getValue()); 
        newData.put("Systolic Bloodpressure", systolicPressure_jTextField.getText());
        newData.put("Diastolic Bloodpressure", diastolicPressure_jTextField.getText());
        newData.put("Body Age", bodyAge); 
        newData.put("Skeletal Mass", skeletalMass);
        newData.put("Lean Body Mass", leanBodyMass);
        newData.put("Recommendation", "Choose Minimally porcessed, whole foods, whole grains, vegetables, fruits, nuts, healthful sources of protein (fish, poultry, beans) and plant oils.");
        
        JSONObject newObject = new JSONObject();
        

        // Create or update the JSON file
        File jsonFile = new File(folderPath, fileName);

        if (jsonFile.exists()) {
            // If the file exists, read existing data and merge with new data
            JSONObject existingData = readExistingData(jsonFile);
            if (existingData != null) {
               String existingJson= existingData.toString();
               String lastName =null;
        try {
            ObjectMapper objectMapper = new ObjectMapper();
            JsonNode jsonNode = objectMapper.readTree(existingJson);

            
            // Get the last object's name 
            Iterator<Map.Entry<String, JsonNode>> fields = jsonNode.fields();
            while(fields.hasNext()) {
                Map.Entry<String, JsonNode> entry = fields.next();
                lastName = entry.getKey();
                System.out.println("Name of the first object: " + lastName);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
        int id = Integer.parseInt(lastName)+1;
        
           newObject.put(id, newData);
                existingData.putAll(newObject);
                writeDataToFile(existingData, jsonFile);
            }
        } else {
            // If the file doesn't exist, write new data directly
            newObject.put("1", newData);
            writeDataToFile(newObject, jsonFile);
        }
        
    }
        
     
    private static JSONObject readExistingData(File jsonFile) {
        try (FileReader fileReader = new FileReader(jsonFile)) {
            return (JSONObject) JSONValue.parse(fileReader);
        } catch (IOException e) {
            System.err.println("Error reading existing JSON data: " + e.getMessage());
            return null;
        }
    }

    private static void writeDataToFile(JSONObject data, File jsonFile) {
        try (FileWriter fileWriter = new FileWriter(jsonFile)) {
            JSONValue.writeJSONString(data, fileWriter);
            System.out.println("JSON file updated with new data: " + jsonFile.getAbsolutePath());
        } catch (IOException e) {
            System.err.println("Error writing to the JSON file: " + e.getMessage());
        }
    }
    
    
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(serialCommunicationGUI.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>
        /* Create and display the form */
    try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(serialCommunicationGUI.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(serialCommunicationGUI.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(serialCommunicationGUI.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(serialCommunicationGUI.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }

        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new serialCommunicationGUI().setVisible(true);
            }
        });
  
    }
    

}


